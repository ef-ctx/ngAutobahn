!function(a){"use strict";a.module("ngAutobahn.connection",["ngAutobahn.utils.ping"]).constant("NG_AUTOBAHN_CONNECTION_STATUS",{OPENED:"ngAutobahn.connection.state.opened",CLOSED:"ngAutobahn.connection.state.closed",LOST:"ngAutobahn.connection.state.lost"}).constant("NG_AUTOBAHN_CONNECTION_EVENTS",{OPEN:"ngAutobahn.connection.open",CLOSE:"ngAutobahn.connection.close",LOST:"ngAutobahn.connection.lost"}).provider("ngAutobahnConnection",["PingProvider",function(b){var c={},d={mockMode:!1,url:null,realm:null,retries:{max:100,initialDelay:3,delayGrowthFactor:1.5,maxDelay:300,delayJitter:.1},ping:{delay:5e3,timeout:1e4}};this.configure=function(e){a.extend(d,e),c={url:d.url,realm:d.realm,max_retries:d.retries.max,initial_retry_delay:d.retries.initialDelay,retry_delay_growth:d.retries.delayGrowthFactor,max_retry_delay:d.retries.maxDelay,retry_delay_jitter:d.retries.delayJitter},b.configure({delay:d.ping.delay,maxResponseDelay:d.ping.timeout})},this.$get=["$q","$rootScope","Ping","NG_AUTOBAHN_CONNECTION_STATUS","NG_AUTOBAHN_CONNECTION_EVENTS",function(a,b,d,e,f){function g(){function g(){var b=a.defer();return s?(b.resolve(r),n()):(s=new autobahn.Connection(c),s.onopen=function(a){r=a,v.start(),b.resolve(a),n()},s.onclose=function(a){b.reject(),l()},s.open()),b.promise}function h(){return i().then(m)}function i(){var b=a.defer();return s?(v.stop(),s.onclose=function(a){s=null,b.resolve()},s.close()):b.reject(),b.promise}function j(){l(),i().then(g)}function k(){return r.call("ping")}function l(){u=e.LOST,q()}function m(){u=e.CLOSED,p()}function n(){u=e.OPENED,o()}function o(){b.$broadcast(f.OPEN,r)}function p(a){b.$broadcast(f.CLOSE,a)}function q(a){b.$broadcast(f.LOST,a)}var r,s,t=this,u=e.CLOSED,v=new d(k,j);t.openConnection=g,t.closeConnection=h,Object.defineProperty(t,"status",{get:function(){return u}}),Object.defineProperty(t,"isOpen",{get:function(){return u===e.OPENED}}),Object.defineProperty(t,"isClosed",{get:function(){return u===e.CLOSED}}),Object.defineProperty(t,"isLost",{get:function(){return u===e.LOST}})}return new g}]}])}(angular),function(a){"use strict";a.module("ngAutobahn.messageBroker",[]).factory("NgAutobahnMessageBroker",["$rootScope",function(a){function b(b,c){function d(a,b){k[a]||(k[a]=[]),k[a].push(b)}function e(a,b){return c(j,a,b)}function f(){return j}function g(b,c){var d=c.channel,e=c.type,f=c.data;h(d,e)&&a.$applyAsync(function(){i(e,f)})}function h(a,b){return j===a&&k[b]}function i(a,b){for(var c=k[a],d=0;d<c.length;d++)c[d](b)}var j=b,k={};return{facade:{publish:e,subscribe:d,getChannel:f},messageReceivedHandler:g}}return b}])}(angular),function(a){"use strict";a.module("ngAutobahn",["ngAutobahn.connection","ngAutobahn.session"])}(angular),function(a){"use strict";a.module("ngAutobahn.session",["ngAutobahn.connection","ngAutobahn.messageBroker"]).service("ngAutobahnSession",["$q","$rootScope","ngAutobahnConnection","NgAutobahnMessageBroker","NG_AUTOBAHN_CONNECTION_EVENTS",function(a,b,c,d,e){function f(){function f(b){function d(){e.resolve(f.facade)}var e=a.defer(),f=h(b);if(!b)throw new Error("ngAutobahn.session.subscribe error: Trying to subscribe withous specifying channel");return t?(i(f,b),d()):c.openConnection().then(g)["finally"](d),e.promise}function g(a){t=a}function h(a){var b=new d(a,n);return v[a]||(v[a]=[]),v[a].push(b),b}function i(a,b){function c(a){u.push(a)}t.subscribe(b,a.messageReceivedHandler).then(c)}function j(){for(var a in v)for(var b=v[a],c=0;c<b.length;c++)i(b[c],a)}function k(a,b){t||(t=b,j())}function l(a,b){t=null,u=[]}function m(d,e){function f(){t.call(d,[],e).then(g.resolve,g.reject)["finally"](b.$applyAsync)}var g=a.defer();return t?f():c.openConnection().then(f),g.promise}function n(c,d,e){var f,g,h=a.defer();return t?(f=o(d,e),g={acknowledge:!0},t.publish(c,[],o(d,e),g).then(h.resolve,h.reject)["finally"](b.$applyAsync)):h.reject("ngAutobahnConnection error no session was established"),h.promise}function o(a,b){return{type:a,data:b||{}}}function p(){return q()}function q(){var b=a.defer();return r(),s(),c.closeConnection().then(b.resolve,b.reject),b.promise}function r(){return u.length>0?(t.unsubscribe(u.pop()),r()):void 0}function s(){v=[]}var t,u=[],v={};this.subscribe=f,this.remoteCall=m,this.end=p,b.$on(e.OPEN,k),b.$on(e.CLOSE,l),b.$on(e.LOST,l)}return new f}])}(angular),function(a){"use strict";a.module("ngAutobahn.utils.ping",[]).provider("Ping",[function(){var b={delay:1500,maxResponseDelay:3e3};this.configure=function(c){a.extend(b,c)},this.$get=["$timeout","$interval",function(a,c){function d(d,e){function f(){g(),h(),m=c(h,b.delay,0,!1)}function g(){j(),k()}function h(){l=a(i,b.maxResponseDelay),d().then(j)}function i(){g(),e()}function j(){a.cancel(l)}function k(){c.cancel(m)}var l,m,n=this;n.start=f,n.stop=g}return d}]}])}(angular);